{% extends 'base.html' %}

{% block content %}
<h2 class="mb-4">Admin Dashboard</h2>

<p>Welcome, Admin! Manage your products, hero banner, logo, background, orders, and categories:</p>

<!-- âœ… Quick Actions -->
<div class="mb-4">
  <a href="{{ url_for('admin_orders') }}" class="btn btn-outline-primary me-2">ðŸ“¦ View All Orders</a>
  <a href="{{ url_for('admin_categories') }}" class="btn btn-outline-secondary">ðŸ“‚ Manage Categories</a>
</div>

<!-- âœ… Add New Product -->
<div class="card p-4 mb-5 shadow-sm">
  <h4>Add New Product</h4>
  <form method="POST" enctype="multipart/form-data" action="{{ url_for('add_product') }}">
    <div class="mb-3">
      <label>Name</label>
      <input type="text" name="name" class="form-control" required>
    </div>
    <div class="mb-3">
      <label>Description</label>
      <textarea name="description" class="form-control" required></textarea>
    </div>
    <div class="mb-3">
      <label>Price</label>
      <input type="number" step="0.01" name="price" class="form-control" required>
    </div>
    <div class="mb-3">
      <label>Category</label>
      <select name="category_id" class="form-select" required>
        <option value="">-- Select Category --</option>
        {% for cat in categories %}
          <option value="{{ cat.id }}">{{ cat.name }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="mb-3">
      <label>Product Image</label>
      <input type="file" name="image" class="form-control" required>
    </div>
    <button type="submit" class="btn btn-success">Add Product</button>
  </form>
</div>

<!-- âœ… Product List -->
<h4>All Products</h4>
<table class="table table-bordered table-striped">
  <thead class="table-dark">
    <tr>
      <th>ID</th><th>Name</th><th>Price</th><th>Image</th><th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for product in products %}
    <tr>
      <td>{{ product.id }}</td>
      <td>{{ product.name }}</td>
      <td>PKR {{ '%.2f'|format(product.price) }}</td>
      <td>
        <img src="{{ url_for('static', filename='uploads/' ~ product.image) }}" width="60" class="rounded shadow">
      </td>
      <td>
        <a href="{{ url_for('delete_product', product_id=product.id) }}" class="btn btn-sm btn-danger">Delete</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- âœ… Upload Hero Banner -->
<div class="card p-4 mb-5 shadow-sm">
  <h4>Upload Hero Banner</h4>
  <form method="POST" enctype="multipart/form-data" action="{{ url_for('upload_banner') }}">
    <div class="mb-3">
      <label>Banner Image</label>
      <input type="file" name="banner" class="form-control">
    </div>
    <div class="mb-3">
      <label>Banner Video (MP4)</label>
      <input type="file" name="banner_video" class="form-control">
    </div>
    <button type="submit" class="btn btn-primary">Upload Banner</button>
  </form>
  {% if banner.filename %}
    <p class="mt-3">Current Banner Image:</p>
    <img src="{{ url_for('static', filename='uploads/banners/' ~ banner.filename) }}" class="img-fluid rounded shadow">
  {% endif %}
  {% if banner.video %}
    <p class="mt-3">Current Banner Video:</p>
    <video src="{{ url_for('static', filename='uploads/banners/' ~ banner.video) }}" autoplay muted loop controls class="img-fluid rounded shadow"></video>
  {% endif %}
</div>

<!-- âœ… Upload Shop Logo -->
<div class="card p-4 mb-5 shadow-sm">
  <h4>Upload Shop Logo</h4>
  <form method="POST" enctype="multipart/form-data" action="{{ url_for('upload_logo') }}">
    <div class="mb-3">
      <label>Logo Image</label>
      <input type="file" name="logo" class="form-control" required>
    </div>
    <button type="submit" class="btn btn-info">Upload Logo</button>
  </form>
  {% if logo %}
    <p class="mt-3">Current Logo:</p>
    <img src="{{ url_for('static', filename='uploads/logos/' ~ logo.filename) }}" class="img-fluid rounded shadow" style="max-height: 100px;">
  {% endif %}
</div>

<!-- âœ… Upload Background -->
<div class="card p-4 mb-4 shadow-sm">
  <h4>Upload Background Theme</h4>
  <form method="POST" enctype="multipart/form-data" action="{{ url_for('upload_background') }}">
    <div class="mb-3">
      <label>Background Image</label>
      <input type="file" name="background" class="form-control" required>
    </div>
    <button type="submit" class="btn btn-secondary">Upload Background</button>
  </form>
  {% if background %}
    <p class="mt-3">Current Background:</p>
    <img src="{{ url_for('static', filename='uploads/backgrounds/' ~ background.filename) }}" class="img-fluid rounded shadow">
  {% endif %}
</div>

{% endblock %}
